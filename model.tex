\chapter{Models}
\label{cha:modeli}

All sense embedding models are based on the Skip-gram model. So firstly I will introduce the Skip-gram model, and then describe how other models extend the it. \\

%--------------------------------------------------------------------------------------------------------------------------------%

\section{Context clustering}


\section{Expectation-maximization algorithm}

Each Input embedding has multiple prototypes. Each prototype has a prior probability. Other things are same as skip-gram model. \\

\subsection{Some criticism for context clustering}
The performance of these multi-prototype models is quite sensitive to the clustering algorithm and requires much effort in clustering implementation and parameter tuning.\\

The lack of probabilistic explanation also refrains clustering based methods from being applied to many text mining tasks, such as language modelling. 


\subsection{Multi-Prototype Skip-Gram Model}

\textbf{Objective function:}\\
$$\mathrm{G}=\frac{1}{T}\sum_{t=1}^T\sum_{-c\leq j\leq c,j\neq0}\mathrm{log}\ p(w_{t+j}|w_t)$$ 

\textbf{Multi-Prototype Input Embedding:}\\
$$p(w_O|w_I) = \sum_{i = 1}^{N_{w_I}}P(w_O|h_{w_I}=i,w_I)P(h_{w_I}=i|w_I)$$

\textbf{Using Hierarchical Softmax:}\\
$$P(w_O|h_{w_I}=i,w_I) = \prod_{j=1}^{L(w)-1}\sigma\left(\left[n(w_O,j+1)=ch(n(w_O,j))\right]\cdot {U_{n(w_O,j)}}^{\rm T}V_{w_I,i}\right)$$ 

\subsection{EM Algorithm}

Suppose there are $M$ word pairs for training: $\{(w_1,w),(w_2,w),(w_3,w),\ldots,(w_M,w)\}$

$$\mathrm{log}\ P(\mathbb{X},$$

\textbf{E-Step:}\\

\textbf{M-Step:}\\

%--------------------------------------------------------------------------------------------------------------------------------%

\section{Sense Assignment Model (my model)}

Last model considers that only input embedding has multi-prototype. In contrast, my model considers that both input embedding and output embedding has multi-prototype. In other words, each word in sentence have different information. \\

Each iteration, fetch a batch of data. Assign sentence, update 

\subsection{Model}

\subsection{Training}

\textbf{Assignment:}\\



\textbf{}

\textbf{Train:}\\
